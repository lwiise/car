<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EZ — Gallery</title>
<link href="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.css" rel="stylesheet" />
<style>
  :root{
    --bg:#fff;
    --text-main:#222;
    --accent:#333;
    --card-radius:32px;
    --btn-radius:30px;
    --map-height:50vh;
    /* extra height the map receives when the filter bar is hidden in solo mode */
    --map-extra:0px;
  }

  /* =========== Base =========== */
  *,*::before,*::after{ box-sizing:border-box; -webkit-font-smoothing:antialiased; }
  body{
    margin:0; background:var(--bg); color:var(--text-main);
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
  }
  a{ color:inherit; text-decoration:none; }

  body.is-developer{
    --map-height:50vh;
    overflow:hidden;
  }
  body.is-solo{
    --map-height:50vh;
  }
  body.is-developer #map{
    border-bottom:6px solid #000;
  }

  /* Make Mapbox attribution/logo small & subtle */
  .mapboxgl-ctrl-bottom-left,
  .mapboxgl-ctrl-bottom-right{
    transform:scale(.6);
    transform-origin:bottom right;
    opacity:.35;
  }

  /* =========== Top Nav (unchanged look) =========== */
  .topnav-wrap{
    position:fixed; inset: 14px 0 auto 0; display:flex; justify-content:center; z-index:50; pointer-events:none;
  }
  .topnav{
    pointer-events:auto;
    display:flex; gap:22px; align-items:center; padding:12px 22px;
    background:rgba(0,0,0,0.6); color:#fff; border-radius:999px; backdrop-filter:blur(10px);
    box-shadow:0 8px 24px rgba(0,0,0,0.25);
  }
  .topnav .pill{
    font-size:13px; font-weight:800; text-transform:uppercase; letter-spacing:.05em;
    opacity:.85; padding:9px 14px; border-radius:12px; transition:.2s ease; cursor:pointer;
  }
  .topnav .pill:hover{ opacity:1; }
  .topnav .pill.active{ background:rgba(255,255,255,0.18); }

  /* =========== Map (40% viewport height) =========== */
  #map{
    width:100%;
    height: var(--map-height); /* <-- no extra height anymore */
    position:relative;
    background:#000;
    /* black & white look */
    filter:grayscale(1) contrast(1.08);
  }

  /* Sticky map only in solo mode */
  body.is-solo #map{
    position:sticky;
    top:0;
    z-index:20;
  }

  body.is-developer .shop-head{ display:none; }
  body.is-developer #sect-gallery{
    width:100%;
    margin:0;
    padding:0;
  }
  body.is-solo #sect-gallery{
    padding:0 24px;
  }
  body.is-solo #soloBlock{
    margin-top:0;
    min-height:calc(100vh - var(--map-height));
    display:flex;
    flex-direction:column;
  }
  body.is-solo .solo{
    grid-template-columns:minmax(0,0.8fr) minmax(0,1.2fr);
  }
  body.is-solo #soloBlock .solo{
    flex:1;
  }

  /* =========== Sections wrapper =========== */
  .page{
    display:block; width:100%; overflow-x:hidden;
  }

  .section{
    width: min(1200px, 100%);
    margin: 0 auto;
    padding: 24px 24px 60px;
  }

  /* =========== GALLERY FILTER BAR (unchanged) =========== */
  .shop-head{
    position:sticky; top:0;
    background:#fff; z-index:10;
    padding: 8px 0 18px;
    border-bottom:none;
  }
  .filter-row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .chip{
    border:none;
    background:#f4f4f4;
    color:#7a7a7a;
    font-weight:800;
    padding:8px 16px;
    border-radius:999px;
    cursor:pointer;
    font-size:10px;
    letter-spacing:.08em;
    text-transform:uppercase;
    box-shadow:none;
    transition:background .2s ease, color .2s ease, box-shadow .2s ease;
  }
  .chip:hover{ background:#efefef; }
  .chip.active{
    background:#111;
    color:#fff;
    box-shadow:0 6px 14px rgba(0,0,0,0.18);
  }

  /* Hide the filter bar only while in solo view */
  body.is-solo .shop-head{ display:none; }

  /* =========== GRID CARDS (unchanged) =========== */
  .grid{ display:grid; grid-template-columns:repeat(auto-fill, minmax(220px,1fr)); gap:24px; }
  .card{
    background:#fff; border:1px solid #f3f3f3; border-radius:24px; padding:18px;
    cursor:pointer; transition:.25s cubic-bezier(.25,.8,.25,1); text-align:center;
  }
  .card:hover{ transform:translateY(-4px); box-shadow:0 14px 35px rgba(0,0,0,0.07); }
  .card-media{
    height:140px; display:flex; align-items:center; justify-content:center; margin-bottom:12px;
    border-radius:18px; overflow:hidden; background:#fafafa;
  }
  .card-media img{ width:100%; height:100%; object-fit:cover; }
  .card-name{ font-size:12px; font-weight:900; color:#919191; letter-spacing:.08em; text-transform:uppercase; }
  .card-sub{ font-size:10px; color:#c7c7c7; text-transform:uppercase; }

  /* =========== SOLO VIEW (product) LEFT/RIGHT =========== */
  .solo{
    display:grid; grid-template-columns:minmax(0,1.1fr) minmax(0,.9fr);
    gap:32px; align-items:start;
    background:#fff; border-radius:28px; border:1px solid #eee; padding:24px; box-shadow:0 12px 28px rgba(0,0,0,0.06);
  }
  .media-panels{
    background:#0b0b0b; border-radius:20px; padding:16px; color:#fff;
  }
  .mode-tabs{ display:flex; gap:10px; margin-bottom:10px; }
  .mode-btn{
    background:#2a2a2a; border:none; color:#fff; font-weight:800; letter-spacing:.04em; text-transform:uppercase;
    font-size:11px; border-radius:999px; padding:9px 14px; cursor:pointer; opacity:.85; transition:.2s;
  }
  .mode-btn.active, .mode-btn:hover{ opacity:1; background:#3a3a3a; }
  .media-stage{
    position:relative;
    width:100%;
    height:auto;
    aspect-ratio:16 / 9;
    border-radius:16px;
    overflow:hidden;
    background:#000;
  }
  .media-stage img, .media-stage video, .media-stage model-viewer{ width:100%; height:100%; object-fit:cover; display:block; }

  .solo-title{ margin:0 0 6px; font-size:28px; font-weight:900; letter-spacing:-.01em; }
  .solo-sub{ margin:0 0 18px; color:#666; }
  .specs{ display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:16px; margin:18px 0 22px; }
  .spec h5{ margin:0 0 6px; font-size:10px; letter-spacing:.12em; text-transform:uppercase; color:#999; }
  .spec div{ font-size:14px; font-weight:800; }

  .artist{
    display:flex; align-items:center; gap:14px; padding:14px; border-radius:16px; background:#f7f7f7; border:1px solid #eee;
  }
  .avatar{ width:46px; height:46px; border-radius:50%; overflow:hidden; background:#eaeaea; }
  .avatar img{ width:100%; height:100%; object-fit:cover; }
  .artist-name{ font-weight:800; font-size:14px; }
  .artist-role{ color:#888; font-size:12px; }
  .artist-cta{ margin-left:auto; font-size:12px; font-weight:800; text-transform:uppercase; letter-spacing:.06em; color:#222; }

  .solo-actions{ display:flex; gap:10px; margin-top:14px; }
  .btn{ padding:12px 16px; border:none; border-radius:12px; font-weight:800; cursor:pointer; }
  .btn-dark{ background:#111; color:#fff; }
  .btn-light{ background:#efefef; color:#444; }

  .back-row{ margin-top:18px; }
  .link-back{ display:inline-flex; align-items:center; gap:8px; font-weight:800; color:#666; }

  /* =========== DEVELOPER VIEW (map 60% + slider 40%) =========== */
  #developerBlock{ display:none; margin-top:0; }
  body.is-developer #developerBlock{ display:block; }
  .dev-slider{
    position:relative;
    height:calc(100vh - var(--map-height));
    width:100%;
    border-radius:0;
    overflow:hidden;
    background:#fff;
    display:flex;
  }
  .dev-text{
    flex:0 0 40%;
    display:flex;
    align-items:center;
    background:#e3e3e3;
    color:#111;
  }
  .dev-text-inner{
    position:relative;
    z-index:1;
    padding:0 48px;
    max-width:520px;
  }
  .dev-media{
    position:relative;
    flex:1 1 60%;
    overflow:hidden;
  }
  .dev-media::before{
    content:"";
    position:absolute;
    inset:0;
    background:transparent;
    z-index:1;
    pointer-events:none;
  }
  .dev-slide-img{
    width:100%;
    height:100%;
    object-fit:cover;
    object-position:right center;
    display:block;
    opacity:1;
    transition:opacity .6s ease;
  }
  .dev-kicker{
    font-size:11px;
    letter-spacing:.08em;
    text-transform:uppercase;
    color:#6b6b6b;
    margin-bottom:10px;
  }
  .dev-title{
    margin:0 0 16px;
    font-size:32px;
    font-weight:900;
    letter-spacing:-.02em;
    color:#111;
  }
  .dev-cta{
    border:none;
    background:#e64a4a;
    color:#fff;
    font-weight:800;
    border-radius:999px;
    padding:12px 22px;
    font-size:14px;
    cursor:pointer;
    box-shadow:0 10px 22px rgba(230,74,74,0.35);
  }
  .dev-actions{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    align-items:center;
  }
  .dev-back-btn{
    border:1px solid #d9d9d9;
    background:#fff;
    color:#111;
    font-weight:800;
    border-radius:999px;
    padding:12px 18px;
    font-size:13px;
    cursor:pointer;
  }
  .dev-dots{
    position:absolute;
    left:16px;
    bottom:14px;
    display:flex;
    gap:8px;
    z-index:2;
  }
  .dev-arrow{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    width:42px;
    height:42px;
    border:none;
    border-radius:50%;
    background:rgba(0,0,0,0.5);
    color:#fff;
    font-size:24px;
    cursor:pointer;
    z-index:2;
  }
  .dev-prev{ left:12px; }
  .dev-next{ right:12px; }
  .dev-dot{
    width:7px; height:7px; border-radius:999px;
    background:rgba(0,0,0,0.35);
  }
  .dev-dot.active{ background:#111; }

  /* ======== 360 custom control (unchanged) ======== */
  .video360-shell{ height:100%; display:flex; flex-direction:column; }
  .video360-main{ flex:1; width:100%; height:calc(100% - 40px); object-fit:cover; }
  .video360-bar{ display:flex; align-items:center; gap:10px; padding:6px 12px 10px; background:#2f2f2f; }
  .video360-play{
    width:26px; height:26px; border-radius:999px; border:1px solid rgba(255,255,255,.2); background:transparent; color:#fff;
    display:flex; align-items:center; justify-content:center; font-size:12px; cursor:pointer;
  }
  .video360-range{ -webkit-appearance:none; appearance:none; width:100%; height:18px; border-radius:999px; background:#121212; }
  .video360-range::-webkit-slider-thumb{ -webkit-appearance:none; width:52px; height:18px; border:none; border-radius:999px; background:#f5f5f5; }
  .video360-range::-moz-range-thumb{ width:52px; height:18px; border:none; border-radius:999px; background:#f5f5f5; }

  /* ======== Modal quick style (kept minimal) ======== */
  .modal-overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.4); display:none; align-items:center; justify-content:center; z-index:99; }
  .modal-overlay.open{ display:flex; }
  .modal-box{ width:min(420px, 92vw); background:#fff; border-radius:20px; padding:24px; box-shadow:0 20px 40px rgba(0,0,0,.22); }
  .modal-close{ position:absolute; top:16px; right:18px; background:none; border:none; font-size:20px; color:#888; cursor:pointer; }
  .modal-header{ text-align:center; margin-bottom:14px; }
  .modal-avatar{ width:84px; height:84px; border-radius:50%; overflow:hidden; margin: 0 auto 12px; }
  .modal-avatar img{ width:100%; height:100%; object-fit:cover; }
  .modal-sub{ font-size:12px; color:#999; text-transform:uppercase; letter-spacing:.08em; }

  @media (max-width: 980px){
    .solo{ grid-template-columns: 1fr; }
    .media-stage{ height:auto; }
    .specs{ grid-template-columns: 1fr 1fr; }
    .dev-text-inner{ padding:0 32px; }
    .dev-title{ font-size:26px; }
  }
  @media (max-width: 620px){
    .specs{ grid-template-columns: 1fr; }
    .dev-text-inner{ padding:0 22px; max-width:100%; }
    .dev-title{ font-size:22px; }
  }

</style>
</head>
<body>
<!-- Top navigation (unchanged look) -->
<div class="topnav-wrap">
  <nav class="topnav" id="mainNav">
    <div class="pill" data-target="sect-home">Home</div>
    <div class="pill" data-target="sect-about">About Us</div>
    <div class="pill active" data-target="sect-gallery">Gallery</div>
    <div class="pill" data-target="sect-contact">Contacts</div>
  </nav>
</div>

<!-- Map -->
<div id="map"></div>

<!-- PAGE -->
<main class="page">

  <!-- HOME -->
  <section class="section" id="sect-home" style="display:none;">
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:28px; align-items:center;">
      <img src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c2b69244939dba62178d_1%20(2).png" alt="" style="width:100%; border-radius:20px; object-fit:cover;">
      <div style="text-align:center;">
        <h1 style="margin:0 0 10px; font-size:42px; letter-spacing:-.02em;">Welcome to ADS Online</h1>
        <p style="margin:0 0 18px; color:#666;">Discover curated real estate opportunities with modern spaces designed for living and investment.</p>
        <button class="btn btn-dark" onclick="switchSection('sect-gallery')">Explore projects</button>
      </div>
    </div>
  </section>

  <!-- ABOUT -->
  <section class="section" id="sect-about" style="display:none;">
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:28px; align-items:center;">
      <div style="text-align:center;">
        <h2 style="margin:0 0 10px; font-size:36px; letter-spacing:-.02em;">About Us</h2>
        <p style="margin:0; color:#666;">ADS Online connects buyers and investors with curated real estate projects, blending smart design, strong locations, and long-term value.</p>
      </div>
      <img src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6953aa69b55402acf02ca121_WhatsApp%20Image%202025-12-30%20at%2011.20.32%20(1).jpeg" alt="Studio" style="width:100%; border-radius:20px; object-fit:cover;">
    </div>
  </section>

  <!-- GALLERY -->
  <section class="section" id="sect-gallery">
    <!-- Filter bar (will be hidden in solo via body.is-solo) -->
    <header class="shop-head">
      <div class="filter-row">
        <button class="chip active" data-filter="all" id="chipAll">ALL</button>
        <button class="chip" data-filter="developers">DEVELOPERS</button>
        <button class="chip" data-filter="projects">PROJECTS</button>
      </div>
    </header>

    <!-- Grid -->
    <div class="grid" id="grid"></div>

    <!-- SOLO (product) -->
    <div id="soloBlock" style="display:none; margin-top:18px;">
      <div class="solo">
        <!-- LEFT -->
        <div class="media-panels">
          <div class="mode-tabs">
            <button class="mode-btn active" data-mode="images">Images</button>
            <button class="mode-btn" data-mode="360">360</button>
            <button class="mode-btn" data-mode="video">Video</button>
            <button class="mode-btn" data-mode="3d">3D</button>
          </div>
          <div class="media-stage" id="mediaStage"></div>
        </div>

        <!-- RIGHT -->
        <div>
          <h2 class="solo-title" id="soloTitle">TOWER CONCEPT 01</h2>
          <p class="solo-sub">Contemporary automotive sculpture with a functional soul.</p>

          <div class="specs">
            <div class="spec"><h5>Material</h5><div id="spMat">Concept Finish</div></div>
            <div class="spec"><h5>Dimensions</h5><div id="spDim">Full-size SUV</div></div>
            <div class="spec"><h5>Location</h5><div id="soloStore">Tower Studio, London</div></div>
          </div>

          <div class="artist" id="artistCard">
            <div class="avatar"><img id="artistImg" src="" alt=""></div>
            <div>
              <div class="artist-name" id="artistName">Finna Studio</div>
              <div class="artist-role" id="artistRole">Automotive Concept</div>
            </div>
            <div class="artist-cta" id="openArtist">View Bio →</div>
          </div>

          <div class="solo-actions">
            <button class="btn btn-dark" id="btnContact">Contact</button>
            <button class="btn btn-light" id="btnClose">Close</button>
          </div>
        </div>
      </div>

      <div class="back-row">
        <a class="link-back" id="btnBack">← Back to Collection</a>
      </div>
    </div>

    <!-- DEVELOPER DETAIL -->
    <div id="developerBlock" style="display:none; margin-top:0;">
      <div class="dev-slider" id="devSlider">
        <div class="dev-text">
          <div class="dev-text-inner">
            <div class="dev-kicker">Developer project directory</div>
            <h3 class="dev-title">Original Art For Work</h3>
            <div class="dev-actions">
              <button class="dev-cta" id="devSeeMore" type="button">See More</button>
              <button class="dev-back-btn" id="devBackBtn" type="button">Back to Collection</button>
            </div>
          </div>
        </div>
        <div class="dev-media">
          <img id="devSlideImg" class="dev-slide-img" src="" alt="">
          <button class="dev-arrow dev-prev" id="devPrev" type="button">‹</button>
          <button class="dev-arrow dev-next" id="devNext" type="button">›</button>
          <div class="dev-dots" id="devDots"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section class="section" id="sect-contact" style="display:none;">
    <h2 style="margin:0 0 12px;">Get in Touch</h2>
    <p style="margin:0 0 16px; color:#666;">Interested in this concept car? Reach out and let's talk.</p>
    <form action="https://formsubmit.co/anaskaroti@gmail.com" method="POST" style="max-width:520px;">
      <input type="hidden" name="_captcha" value="false">
      <input type="hidden" name="_template" value="table">
      <div style="display:grid; gap:12px;">
        <input required name="name" placeholder="Your Name" style="padding:12px 14px; border:1px solid #eee; border-radius:12px;">
        <input required name="email" type="email" placeholder="Your Email" style="padding:12px 14px; border:1px solid #eee; border-radius:12px;">
        <input name="subject" id="formSubject" placeholder="Subject" style="padding:12px 14px; border:1px solid #eee; border-radius:12px;">
        <textarea name="message" rows="3" placeholder="Message..." style="padding:12px 14px; border:1px solid #eee; border-radius:12px;"></textarea>
        <button class="btn btn-dark" type="submit">Send Inquiry</button>
      </div>
    </form>
  </section>
</main>

<!-- Artist Modal -->
<div class="modal-overlay" id="artistModal">
  <div class="modal-box" style="position:relative;">
    <button class="modal-close" id="closeArtistModal">×</button>
    <div class="modal-header">
      <div class="modal-avatar"><img id="modalArtistImg" src="" alt=""></div>
      <h3 id="modalArtistName" style="margin:0;"></h3>
      <div class="modal-sub" id="modalArtistRole"></div>
    </div>
    <p id="modalArtistBio" style="margin:0; color:#555; line-height:1.6;"></p>
  </div>
</div>

<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.js"></script>
<script>
/* =================== MAP =================== */
const MAPBOX_TOKEN = "pk.eyJ1IjoiYW5hc2thcm90aSIsImEiOiJjbWhqcHgwcmMwbWM0MmxwZ2V5Z2x5OTN0In0.bpOf-4BsljExZdYZUak_pw";
const USER_STYLE  = "mapbox://styles/anaskaroti/cmhuiic1f00ft01qucn91gk6e";
const DEFAULT_CENTER = [45.0792, 23.8859];
const DEFAULT_ZOOM = 4.0;
const DEV_ZOOM = 15.4;
const DEV_PITCH = 70;
const DEV_ZOOM_CLOSE = 16.2;
const DEV_PITCH_CLOSE = 75;
const DEV_BEARING = 35;
mapboxgl.accessToken = MAPBOX_TOKEN;

const map = new mapboxgl.Map({
  container:"map",
  style: USER_STYLE,
  center: DEFAULT_CENTER,
  zoom: DEFAULT_ZOOM,
  pitch:0,
  projection:'globe'
});
map.on('style.load', ()=>{
  try{
    map.setFog({
      color:'rgb(255,255,255)',
      'high-color':'rgb(200,200,200)',
      'space-color':'rgb(0,0,0)',
      'star-intensity':0.6
    });
  }catch(_){}
  try{
    map.setLight({
      anchor:'viewport',
      color:'white',
      intensity:0.6,
      position:[1.5, 210, 30]
    });
  }catch(_){}
  try{
    if(!map.getLayer('3d-buildings') && map.getSource('composite')){
      const layers = map.getStyle().layers || [];
      let labelLayerId = null;
      for(const layer of layers){
        if(layer.type === 'symbol' && layer.layout && layer.layout['text-field']){
          labelLayerId = layer.id;
          break;
        }
      }
      map.addLayer({
        id:'3d-buildings',
        source:'composite',
        'source-layer':'building',
        filter:['==','extrude','true'],
        type:'fill-extrusion',
        minzoom:14,
        paint:{
          'fill-extrusion-color':'#e6e6e6',
          'fill-extrusion-height':['get','height'],
          'fill-extrusion-base':['get','min_height'],
          'fill-extrusion-opacity':0.95
        }
      }, labelLayerId || undefined);
    }
  }catch(_){}
});

/* =================== DATA =================== */
const BASE_VIDEO = "https://raw.githubusercontent.com/lwiise/3d-models/main/Video_Generation_Without_Logo%20(1).mp4";
const SPECIAL_360_VIDEO = "https://raw.githubusercontent.com/lwiise/3d-models/main/D_Car_Studio_Video_Generation.mp4";
const SPECIAL_NORMAL_VIDEO = "https://raw.githubusercontent.com/lwiise/3d-models/main/Untitled%20video%20-%20Made%20with%20Clipchamp%20(9).mp4";
const SPECIAL_IMG = "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69318e85e54ec217dd718990_ChatGPT%20Image%20Dec%203%2C%202025%2C%2005_23_33%20PM.png";
const COVER_IMAGES = [
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6953ac84be583b7269688910_Gemini_Generated_Image_8zigxk8zigxk8zig%20(1).png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c81f19226e03541a50d6_WhatsApp%20Image%202025-12-29%20at%2017.09.52.jpeg",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c509850f48d7f8c54c_Gemini_Generated_Image_sqilmvsqilmvsqil.png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c535f4066b9e65d704_Gemini_Generated_Image_glh30cglh30cglh3.png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c4c0654bff37f62202_Gemini_Generated_Image_8zdjot8zdjot8zdj.png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c35aa4e76b57119ba6_Gemini_Generated_Image_oo0o83oo0o83oo0o.png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c2101e496079b1332b_Gemini_Generated_Image_gmpt40gmpt40gmpt.png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c1829b5e2731725a40_Gemini_Generated_Image_5bjix25bjix25bji.png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6951b9c029e929857a15f190_Gemini_Generated_Image_xfrvpjxfrvpjxfrv.png"
];
const DEVELOPER_IMAGES = [
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c2b623daa6daaae7ce96_BNG%20(36)%20(1).png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c2b69244939dba62178d_1%20(2).png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c2b6c8d88b824f4c0ff5_BNG%20(40)%20(1).png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c2b680b22fc519275ead_BNG%20(41).png",
  "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6952c2b6577cc8a4d124c2b4_BNG%20(38)%20(1).png"
];
const DEV_TOWER_SLIDES = COVER_IMAGES;
const DEVELOPER_LOCATIONS = [
  [[46.6753, 24.7136], [39.1925, 21.4858], [50.1033, 26.4207]],   // Riyadh, Jeddah, Dammam
  [[39.8579, 21.3891], [39.5692, 24.5247], [50.2144, 26.2172]],   // Makkah, Medina, Al Khobar
  [[42.5053, 18.2164], [40.4158, 21.4373], [36.5544, 28.3838]],   // Abha, Taif, Tabuk
  [[38.0667, 24.0889], [49.6583, 27.0377], [41.6994, 27.5114]],   // Yanbu, Jubail, Hail
  [[44.1277, 17.5659], [47.7220, 26.3139], [45.2806, 23.8859]]    // Najran, Al Hofuf, Saudi center
];

const baseCar = {
  category: "projects",
  img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692f5e9a596ee0b96ed1489b_Gemini_Generated_Image_r5gp3jr5gp3jr5gp%20(7).png",
  galleryImages: [
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692f5e9a596ee0b96ed1489b_Gemini_Generated_Image_r5gp3jr5gp3jr5gp%20(7).png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692f5e9a4b2d8f0b234818b1_Gemini_Generated_Image_r5gp3jr5gp3jr5gp%20(1).png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692f5e9a7b3355444dfdad28_Gemini_Generated_Image_r5gp3jr5gp3jr5gp%20(3).png"
  ],
  video: BASE_VIDEO,
  video360: BASE_VIDEO,
  model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764713978813_range%20rover%203d%20model%20(1).glb",
  specs: { mat: "Concept Finish", dim: "Full-size SUV" },
  store: { name: "Tower Studio, London", coords: [-0.1276, 51.5072] },
  artist: {
    name: "Finna Studio",
    role: "Automotive Concept",
    img: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=100&q=80",
    bio: "A luxury SUV concept blending architectural forms with automotive design."
  }
};

function makeDeveloper(name, cardImage, slides, locations){
  const slug = name.toLowerCase().replace(/[^a-z0-9]+/g,'-');
  const cover = cardImage || ((slides && slides.length) ? slides[0] : '');
  return {
    id: `dev-${slug}`,
    name,
    category: "developers",
    img: cover,
    galleryImages: slides,
    devSlides: slides,
    devLocations: locations,
    video: BASE_VIDEO,
    video360: BASE_VIDEO,
    model: baseCar.model,
    specs: { mat: "Brand Identity", dim: "Developer Partner" },
    store: { name: "Developer Hub", coords: [45.0792, 23.8859] },
    artist: {
      name,
      role: "Developer Platform",
      img: cover,
      bio: `${name} tools and services for modern teams.`
    }
  };
}

const PROJECTS = Array.from({length:8}, (_,i)=>{
  const base = { id:`tower-${i+1}`, name:`Tower Concept 0${i+1}`, ...baseCar };
  const cover = COVER_IMAGES[i] || base.img;
  return { ...base, img: cover, galleryImages:[cover] };
});

const DEVELOPERS = [
  makeDeveloper("Developer 01", DEVELOPER_IMAGES[0], DEV_TOWER_SLIDES, DEVELOPER_LOCATIONS[0]),
  makeDeveloper("Developer 02", DEVELOPER_IMAGES[1], DEV_TOWER_SLIDES, DEVELOPER_LOCATIONS[1]),
  makeDeveloper("Developer 03", DEVELOPER_IMAGES[2], DEV_TOWER_SLIDES, DEVELOPER_LOCATIONS[2]),
  makeDeveloper("Developer 04", DEVELOPER_IMAGES[3], DEV_TOWER_SLIDES, DEVELOPER_LOCATIONS[3]),
  makeDeveloper("Developer 05", DEVELOPER_IMAGES[4], DEV_TOWER_SLIDES, DEVELOPER_LOCATIONS[4])
];

const PRODUCTS = [...PROJECTS, ...DEVELOPERS];

/* =================== STATE + HELPERS =================== */
const nav = document.getElementById('mainNav');
function setActivePill(id){
  nav.querySelectorAll('.pill').forEach(p=>{
    p.classList.toggle('active', p.dataset.target === id);
  });
}
function setMapExtra(px){
  document.documentElement.style.setProperty('--map-extra', (px||0)+'px');
}
function calcFilterBarHeight(){
  const sh = document.querySelector('#sect-gallery .shop-head');
  return sh ? sh.offsetHeight : 0;
}
function resetMapToSaudi(){
  if(!map || !map.flyTo) return;
  map.flyTo({
    center: DEFAULT_CENTER,
    zoom: DEFAULT_ZOOM,
    pitch: 0,
    bearing: 0,
    duration: 1200
  });
}

/* =================== SECTION SWITCH =================== */
let rrTimer = null;   // defined here so we can clear it
let devTimer = null;
let devCamTimer = null;

window.switchSection = function(id, opts = {}){
  const { skipScroll = false } = opts;
  // leave solo state if switching
  document.body.classList.remove("is-solo");
  document.body.classList.remove("is-developer");
  setMapExtra(0);
  if(map && map.resize){
    requestAnimationFrame(()=> map.resize());
  }

  // hide solo view and ALWAYS re-show the grid
  document.getElementById("soloBlock").style.display = "none";
  const devBlock = document.getElementById("developerBlock");
  if(devBlock) devBlock.style.display = "none";
  const gridEl = document.getElementById("grid");
  if(gridEl) gridEl.style.display = "grid";

  // stop image autoplay if running
  if(rrTimer){ clearInterval(rrTimer); rrTimer = null; }
  if(devTimer){ clearInterval(devTimer); devTimer = null; }
  if(devCamTimer){ clearTimeout(devCamTimer); devCamTimer = null; }

  ["sect-home","sect-about","sect-gallery","sect-contact"].forEach(s=>{
    const node = document.getElementById(s);
    if(node) node.style.display = (s===id) ? "block" : "none";
  });
  setActivePill(id);
  resetMapToSaudi();

  // scroll so content starts below map
  if(!skipScroll){
    window.scrollTo({
      top: document.getElementById('map').offsetTop + document.getElementById('map').offsetHeight,
      behavior:'smooth'
    });
  }
};

/* top nav events */
nav.querySelectorAll('.pill').forEach(pill=>{
  pill.addEventListener('click', ()=> switchSection(pill.dataset.target, { skipScroll:true }));
});

/* =================== GALLERY RENDER =================== */
const grid = document.getElementById('grid');
function card(p){
  const el = document.createElement('article');
  el.className = 'card';
  const subLabel = p.category === 'developers' ? 'Developer' : 'Concept Car';
  el.innerHTML = `
    <div class="card-media"><img src="${p.img}" alt="${p.name}"></div>
    <div class="card-name">${p.name}</div>
    <div class="card-sub">${subLabel}</div>
  `;
  el.addEventListener('click', ()=>{
    if(p.category === 'developers'){
      openDeveloper(p);
    }else{
      openSolo(p);
    }
  });
  return el;
}
function render(list){
  grid.innerHTML = '';
  list.forEach(p=> grid.appendChild(card(p)));
}
render(PRODUCTS);

/* filters */
document.querySelector('.shop-head')?.addEventListener('click', e=>{
  const btn = e.target.closest('.chip');
  if(!btn) return;
  document.querySelectorAll('.chip').forEach(c=> c.classList.remove('active'));
  btn.classList.add('active');
  const f = btn.dataset.filter;
  render( f==='all' ? PRODUCTS : PRODUCTS.filter(p=>p.category===f) );
  closeDeveloper();
  grid.style.display = 'grid';
});

/* =================== SOLO VIEW (product) =================== */
const soloBlock  = document.getElementById('soloBlock');
const mediaStage = document.getElementById('mediaStage');
let rrMode = 'images';
let rrImages = [];
let rrIndex  = 0;
const developerBlock = document.getElementById('developerBlock');
const devSlideImg = document.getElementById('devSlideImg');
const devDots = document.getElementById('devDots');
const devPrevBtn = document.getElementById('devPrev');
const devNextBtn = document.getElementById('devNext');
let devSlides = [];
let devLocations = [];
let devIndex = 0;

function encodeURL(url){
  return (url||'').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/ /g,'%20');
}

function rrStart(){
  if(!rrImages.length) return;
  if(rrTimer) clearInterval(rrTimer);
  rrTimer = setInterval(()=> rrGo(rrIndex+1), 4000);
}
function rrGo(next){
  if(rrMode!=='images' || !rrImages.length) return;
  const max = rrImages.length;
  rrIndex = ((next%max)+max)%max;
  const img = mediaStage.querySelector('img[data-rr]');
  if(img) img.src = rrImages[rrIndex];
}

function setMode(mode, product){
  rrMode = mode;
  document.querySelectorAll('.mode-btn').forEach(b=>{
    b.classList.toggle('active', b.dataset.mode===mode);
  });

  // stop auto when not in images
  if(rrTimer){ clearInterval(rrTimer); rrTimer=null; }

  if(mode==='images'){
    mediaStage.innerHTML = `<img data-rr src="${rrImages[0]}" alt="${product.name}"/>`;
    rrStart();
    return;
  }

  if(mode==='video'){
    mediaStage.innerHTML = `
      <video autoplay loop muted playsinline controls>
        <source src="${encodeURL(product.video)}" type="video/mp4">
      </video>
    `;
    return;
  }

  if(mode==='360'){
    mediaStage.innerHTML = `
      <div class="video360-shell">
        <video id="rr360Video" class="video360-main" muted playsinline autoplay>
          <source src="${encodeURL(product.video360 || product.video)}" type="video/mp4">
        </video>
        <div class="video360-bar">
          <button class="video360-play" id="rr360PlayBtn">❚❚</button>
          <input type="range" id="rr360Range" class="video360-range" min="0" max="100" step="0.1" value="0">
        </div>
      </div>
    `;
    const v = document.getElementById('rr360Video');
    const b = document.getElementById('rr360PlayBtn');
    const r = document.getElementById('rr360Range');
    v?.addEventListener('loadedmetadata', ()=>{ v.currentTime=0; v.play().catch(()=>{}); });
    v?.addEventListener('timeupdate', ()=>{ if(v.duration){ r.value = (v.currentTime/v.duration)*100; } });
    r?.addEventListener('input', ()=>{ if(v.duration){ v.currentTime = (parseFloat(r.value||'0')/100)*v.duration; v.pause(); } });
    b?.addEventListener('click', ()=>{ if(v.paused){ v.play().catch(()=>{});} else { v.pause(); } });
    v?.addEventListener('play', ()=> b.textContent='❚❚');
    v?.addEventListener('pause',()=> b.textContent='▶');
    return;
  }

  if(mode==='3d'){
    mediaStage.innerHTML = `
      <model-viewer src="${encodeURL(product.model)}"
        camera-controls auto-rotate shadow-intensity="1"
        style="width:100%;height:100%; background:#ffffff;" camera-orbit="45deg 75deg 3m" environment-image="neutral">
      </model-viewer>
    `;
  }
}

function setupMedia(p){
  rrImages = (p.galleryImages && p.galleryImages.length) ? p.galleryImages : [p.img];
  rrIndex  = 0;
  setMode('images', p);

  document.querySelectorAll('.mode-btn').forEach(btn=>{
    btn.onclick = ()=> setMode(btn.dataset.mode, p);
  });
}

function gotoStore(store){
  if(!store) return;
  map.flyTo({ center:store.coords, zoom:16.2, pitch:65, bearing:45, duration:6000 });
}

function openSolo(p, opts = {}){
  const { skipScroll = false } = opts;
  closeDeveloper();
  // fill text
  document.getElementById('soloTitle').textContent = p.name;
  document.getElementById('spMat').textContent     = p.specs.mat;
  document.getElementById('spDim').textContent     = p.specs.dim;
  document.getElementById('soloStore').textContent = p.store.name;

  document.getElementById('artistName').textContent = p.artist.name;
  document.getElementById('artistRole').textContent = p.artist.role;
  document.getElementById('artistImg').src         = p.artist.img;

  document.getElementById('modalArtistName').textContent = p.artist.name;
  document.getElementById('modalArtistRole').textContent = p.artist.role;
  document.getElementById('modalArtistImg').src          = p.artist.img;
  document.getElementById('modalArtistBio').textContent  = p.artist.bio;

  setupMedia(p);
  gotoStore(p.store);

  // show solo; hide grid
  document.getElementById('grid').style.display = 'none';
  soloBlock.style.display = 'block';

  // SOLO MODE: hide filter bar + (now) no extra height for map
  const extra = calcFilterBarHeight();
  setMapExtra(extra); // harmless now, since #map ignores --map-extra
  document.body.classList.add('is-solo');
  if(map && map.resize){
    requestAnimationFrame(()=> map.resize());
  }

  // scroll so solo starts right under map
  if(!skipScroll){
    window.scrollTo({
      top: document.getElementById('map').offsetTop + document.getElementById('map').offsetHeight,
      behavior:'smooth'
    });
  }

  // wire buttons
  document.getElementById('btnClose').onclick = closeSolo;
  document.getElementById('btnBack').onclick  = closeSolo;
  document.getElementById('btnContact').onclick = ()=> switchSection('sect-contact');
  document.getElementById('openArtist').onclick = ()=> document.getElementById('artistModal').classList.add('open');
}

function closeSolo(){
  soloBlock.style.display = 'none';
  document.getElementById('grid').style.display = 'grid';

  // leave sticky mode, reset map height var (no visual effect now)
  document.body.classList.remove('is-solo');
  setMapExtra(0);
  if(map && map.resize){
    requestAnimationFrame(()=> map.resize());
  }

  // stop autoplay
  if(rrTimer){ clearInterval(rrTimer); rrTimer = null; }

  // scroll back to gallery head
  window.scrollTo({
    top: document.getElementById('map').offsetTop + document.getElementById('map').offsetHeight,
    behavior:'smooth'
  });
}

/* =================== DEVELOPER VIEW =================== */
function devUpdateDots(){
  if(!devDots) return;
  devDots.innerHTML = '';
  devSlides.forEach((_, i)=>{
    const dot = document.createElement('span');
    dot.className = 'dev-dot' + (i===devIndex ? ' active' : '');
    devDots.appendChild(dot);
  });
}

function devShow(index){
  if(!devSlides.length || !devSlideImg) return;
  const max = devSlides.length;
  devIndex = ((index%max)+max)%max;
  const next = devSlides[devIndex];

  devSlideImg.style.opacity = 0;
  devSlideImg.onload = ()=>{ devSlideImg.style.opacity = 1; };
  devSlideImg.src = next;
  devSlideImg.alt = `Developer slide ${devIndex+1}`;
  devUpdateDots();

  const loc = devLocations.length ? devLocations[devIndex % devLocations.length] : null;
  if(devCamTimer){ clearTimeout(devCamTimer); devCamTimer = null; }
  if(loc){
    map.flyTo({ center:loc, zoom:DEV_ZOOM, pitch:DEV_PITCH, bearing:DEV_BEARING, duration:10000, essential:true });
    devCamTimer = setTimeout(()=>{
      const nextBearing = (map.getBearing ? map.getBearing() : DEV_BEARING) + 35;
      map.easeTo({ center:loc, zoom:DEV_ZOOM_CLOSE, pitch:DEV_PITCH_CLOSE, bearing:nextBearing, duration:6000, essential:true });
    }, 10000);
  }
}

function devStart(){
  if(devTimer){ clearInterval(devTimer); }
  devTimer = setInterval(()=> devShow(devIndex+1), 16000);
}

function openDeveloper(p){
  // clear product autoplay
  if(rrTimer){ clearInterval(rrTimer); rrTimer = null; }

  // hide other views
  soloBlock.style.display = 'none';
  document.getElementById('grid').style.display = 'none';

  devSlides = (p.devSlides && p.devSlides.length)
    ? p.devSlides
    : ((p.galleryImages && p.galleryImages.length) ? p.galleryImages : [p.img]);
  devLocations = p.devLocations || [];
  devIndex = 0;

  if(developerBlock) developerBlock.style.display = 'block';
  document.body.classList.remove('is-solo');
  document.body.classList.add('is-developer');
  if(map && map.resize){
    requestAnimationFrame(()=> map.resize());
  }

  devShow(0);
  devStart();

  window.scrollTo({
    top: document.getElementById('map').offsetTop,
    behavior:'smooth'
  });

  const backBtn = document.getElementById('devBackBtn');
  if(backBtn) backBtn.onclick = closeDeveloper;
  const seeMoreBtn = document.getElementById('devSeeMore');
  if(seeMoreBtn){
    seeMoreBtn.onclick = ()=> openSolo(PROJECTS[devIndex % PROJECTS.length]);
  }
  if(devPrevBtn){
    devPrevBtn.onclick = ()=>{
      devShow(devIndex-1);
      devStart();
    };
  }
  if(devNextBtn){
    devNextBtn.onclick = ()=>{
      devShow(devIndex+1);
      devStart();
    };
  }
}

function closeDeveloper(){
  if(developerBlock) developerBlock.style.display = 'none';
  document.body.classList.remove('is-developer');
  if(devTimer){ clearInterval(devTimer); devTimer = null; }
  if(devCamTimer){ clearTimeout(devCamTimer); devCamTimer = null; }
  if(map && map.resize){
    requestAnimationFrame(()=> map.resize());
  }
  document.getElementById('grid').style.display = 'grid';
}

/* modal close */
document.getElementById('closeArtistModal').addEventListener('click', ()=> document.getElementById('artistModal').classList.remove('open'));
document.getElementById('artistModal').addEventListener('click', e=>{
  if(e.target.id==='artistModal') e.currentTarget.classList.remove('open');
});

/* default section = Gallery */
switchSection('sect-gallery', { skipScroll:true });
</script>
</body>
</html>
